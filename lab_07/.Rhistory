rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
rename(year.x = 2006)
View(arcos_combo)
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
rename(year.x = x2006)
View(arcos_combo)
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
combo_crosswalk <- inner_join(arcos_combo, state_crosswalk, by = c("state_abb" = "buyer_state"))
View(arcos_combo)
View(combo_crosswalk)
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
arcos_combo %>%
combo_crosswalk <- inner_join(arcos_combo, state_crosswalk, by = c("state_abb" = "buyer_state"))
View(combo_crosswalk)
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
inner_join(state_crosswalk, by = c("state_abb" = "buyer_state"))
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
inner_join(state_crosswalk, by = c("buyer_state" = "state_abb"))
View(arcos_combo)
View(state_crosswalk)
View(combo_crosswalk)
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
inner_join(state_crosswalk, by = c("buyer_state" = "state_abb", "buyer_county", "buyer_state", "total_pills"))
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
inner_join(state_crosswalk, by = c("buyer_state" = "state_abb", "buyer_county", "total_pills"))
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
inner_join(state_crosswalk, by = c("buyer_state" = "state_abb")
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
inner_join(state_crosswalk, by = c("buyer_state" = "state_abb"))
rm(combo_crosswalk)
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
inner_join(state_crosswalk, by = c("buyer_state" = "state_abb"))
View(arcos_combo)
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
inner_join(state_crosswalk, by = c("buyer_state" = "state_abb"))
library(dplyr)
# Assuming arcos_combo is your dataset
arcos_combo <- arcos_combo %>%
mutate(pct_change = ((total_2014 - total_2006) / total_2006) * 100)
View(arcos_combo)
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
inner_join(state_crosswalk, by = c("buyer_state" = "state_abb"))
arcos_combo <- arcos_combo %>%
mutate(pct_change = ((total_2014 - total_2006) / total_2006) * 100)
top_5_states <- arcos_combo %>%
arrange(desc(pct_change)) %>%
slice_max(n = 5)
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
inner_join(state_crosswalk, by = c("buyer_state" = "state_abb"))
arcos_combo <- arcos_combo %>%
mutate(pct_change = ((total_2014 - total_2006) / total_2006) * 100)
top_5_states <- arcos_combo %>%
arrange(desc(pct_change)) %>%
slice_max(pct_change, n = 5)
View(top_5_states)
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
inner_join(state_crosswalk, by = c("buyer_state" = "state_abb"))
arcos_combo <- arcos_combo %>%
mutate(pct_change = ((total_2014 - total_2006) / total_2006) * 100)
top_5_states <- arcos_combo %>%
arrange(desc(pct_change)) %>%
slice_max(pct_change, n = 5)
bottom_5_states <- arcos_combo %>%
arrange(pct_change) %>%
slice_max(pct_change, n = 5)
View(bottom_5_states)
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
inner_join(state_crosswalk, by = c("buyer_state" = "state_abb"))
arcos_combo <- arcos_combo %>%
mutate(pct_change = ((total_2014 - total_2006) / total_2006) * 100)
top_5_states <- arcos_combo %>%
arrange(desc(pct_change)) %>%
slice_max(pct_change, n = 5)
bottom_5_states <- arcos_combo %>%
arrange(pct_change) %>%
slice_min(pct_change, n = 5)
View(bottom_5_states)
View(arcos)
View(arcos_county)
View(state_crosswalk)
View(state_pop_2014)
View(arcos_combo)
View(state_pop_2014)
arcos_combo %>%
inner_join(state_pop_2014, by = c("total_population_2014"))
arcos_combo <- arcos_combo %>%
inner_join(state_pop_2014, by = c("total_population_2014"))
arcos_combo <- arcos_combo %>%
mutate(total_population_2014 = state_pop_2014$total_population_2014)
arcos_combo <- arcos_combo %>%
inner_join(state_pop_2014, by = c("buyer_state" = "state_abb"))
arcos_combo <- arcos_combo %>%
inner_join(state_pop_2014, by = c("buyer_state" = "state"))
View(arcos_combo)
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
inner_join(state_crosswalk, by = c("buyer_state" = "state_abb"))
arcos_combo <- arcos_combo %>%
mutate(pct_change = ((total_2014 - total_2006) / total_2006) * 100)
top_5_states <- arcos_combo %>%
arrange(desc(pct_change)) %>%
slice_max(pct_change, n = 5)
bottom_5_states <- arcos_combo %>%
arrange(pct_change) %>%
slice_min(pct_change, n = 5)
arcos_combo %>%
filter(year == "2014") %>%
group_by(buyer_state) %>%
summarise(total_pills = sum(total_2014))
arcos_combo %>%
filter(year == "2014") %>%
group_by(buyer_state) %>%
summarise(total_pills = sum(total_2014))
opioids_by_state <- arcos_combo %>%
filter(year == "2014") %>%
group_by(buyer_state) %>%
summarise(total_pills = sum(total_2014))
arcos_combo <- arcos_combo %>%
inner_join(state_pop_2014, by = c("state_name" = "state")
arcos_combo <- arcos_combo %>%
inner_join(state_pop_2014, by = c("state_name" = "state"))
arcos_combo <- arcos_combo %>%
inner_join(state_pop_2014, by = c("state_name" = "state"))
mutate(pills_per_person = total_2014/total_population_2014)
arcos_combo <- arcos_combo %>%
inner_join(state_pop_2014, by = c("state_name" = "state")) %>%
mutate(pills_per_person = total_2014/total_population_2014)
View(arcos_combo)
arcos_combo <- arcos_combo %>%
inner_join(state_pop_2014, by = c("state_name" = "state", "geoid", "total_population_2014")) %>%
mutate(pills_per_person = total_2014/total_population_2014)
View(arcos_combo)
arcos_combo <- arcos_combo %>%
inner_join(state_pop_2014, by = c("state_name" = "state"), "geoid", "total_population_2014")) %>%
arcos_combo <- arcos_combo %>%
inner_join(state_pop_2014, by = c("state_name" = "state"), "geoid", "total_population_2014") %>%
mutate(pills_per_person = total_2014/total_population_2014)
arcos_combo <- arcos_combo %>%
inner_join(select(state_pop_2014, state, total_population_2014), by = c("state_name" = "state")) %>%
mutate(pills_per_person = total_2014 / total_population_2014)
arcos_county <- arcos %>%
group_by(countyfips, buyer_county, buyer_state) %>%
summarise(
total_pills = sum(total_pills)
) %>%
inner_join(county_pop_2014, by = c("countyfips" = "geoid")) %>%
mutate(pills_per_person = total_pills/total_population_2014) %>%
arrange(desc(pills_per_person))
arcos_county
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
inner_join(state_crosswalk, by = c("buyer_state" = "state_abb"))
arcos_combo <- arcos_combo %>%
mutate(pct_change = ((total_2014 - total_2006) / total_2006) * 100)
top_5_states <- arcos_combo %>%
arrange(desc(pct_change)) %>%
slice_max(pct_change, n = 5)
bottom_5_states <- arcos_combo %>%
arrange(pct_change) %>%
slice_min(pct_change, n = 5)
View(arcos_combo)
arcos_combo <- arcos_combo %>%
inner_join(select(state_pop_2014, state, total_population_2014), by = c("state_name" = "state")) %>%
mutate(pills_per_person = total_2014 / total_population_2014)
View(arcos_combo)
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
inner_join(state_crosswalk, by = c("buyer_state" = "state_abb"))
arcos_combo <- arcos_combo %>%
mutate(pct_change = ((total_2014 - total_2006) / total_2006) * 100)
top_5_states <- arcos_combo %>%
arrange(desc(pct_change)) %>%
slice_max(pct_change, n = 5)
bottom_5_states <- arcos_combo %>%
arrange(pct_change) %>%
slice_min(pct_change, n = 5)
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
inner_join(state_crosswalk, by = c("buyer_state" = "state_abb"))
arcos_combo <- arcos_combo %>%
mutate(pct_change = ((total_2014 - total_2006) / total_2006) * 100)
top_5_states <- arcos_combo %>%
arrange(desc(pct_change))
bottom_5_states <- arcos_combo %>%
arrange(pct_change) %>%
slice_min(pct_change, n = 5)
View(top_5_states)
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
inner_join(state_crosswalk, by = c("buyer_state" = "state_abb"))
arcos_combo <- arcos_combo %>%
mutate(pct_change = ((total_2014 - total_2006) / total_2006) * 100)
top_5_states <- arcos_combo %>%
group_by(state_name) %>%
summarise(avg_pct_change = mean(pct_change, na.rm = TRUE)) %>%
slice_max(avg_pct_change, n=5)
View(top_5_states)
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
inner_join(state_crosswalk, by = c("buyer_state" = "state_abb"))
arcos_combo <- arcos_combo %>%
mutate(pct_change = ((total_2014 - total_2006) / total_2006) * 100)
top_5_states <- arcos_combo %>%
group_by(state_name) %>%
summarise(avg_pct_change = mean(pct_change, na.rm = TRUE)) %>%
slice_max(avg_pct_change, n=5)
bottom_5_states <- arcos_combo %>%
group_by(state_name) %>%
summarise(avg_pct_change = mean(pct_change, na.rm = TRUE)) %>%
slice_min(avg_pct_change, n=5)
View(bottom_5_states)
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
inner_join(state_crosswalk, by = c("buyer_state" = "state_abb"))
arcos_combo <- arcos_combo %>%
mutate(pct_change = ((total_2014 - total_2006) / total_2006) * 100)
top_5_states <- arcos_combo %>%
group_by(state_name) %>%
summarise(avg_pct_change = mean(pct_change, na.rm = TRUE)) %>%
arrange(desc(avg_pct_change)) %>%
slice_max(avg_pct_change, n=5)
bottom_5_states <- arcos_combo %>%
group_by(state_name) %>%
summarise(avg_pct_change = mean(pct_change, na.rm = TRUE)) %>%
slice_min(avg_pct_change, n=5)
View(top_5_states)
total_2006 <- arcos %>%
filter(year == "2006") %>%
rename(total_2006 = total_pills)
total_2014 <- arcos %>%
filter(year == "2014") %>%
rename(total_2014 = total_pills)
arcos_combo <- inner_join(total_2006, total_2014, by = c("countyfips", "buyer_county", "buyer_state")) %>%
inner_join(state_crosswalk, by = c("buyer_state" = "state_abb"))
arcos_combo <- arcos_combo %>%
mutate(pct_change = ((total_2014 - total_2006) / total_2006) * 100)
top_5_states <- arcos_combo %>%
group_by(state_name) %>%
summarise(avg_pct_change = mean(pct_change, na.rm = TRUE)) %>%
arrange(desc(avg_pct_change)) %>%
slice_max(avg_pct_change, n=5)
bottom_5_states <- arcos_combo %>%
group_by(state_name) %>%
summarise(avg_pct_change = mean(pct_change, na.rm = TRUE)) %>%
arrange(avg_pct_change) %>%
slice_min(avg_pct_change, n=5)
View(bottom_5_states)
pills_2014 <- arcos_combo %>%
group_by(state_name) %>%
inner_join(state_crosswalk, by = "state_name")
View(pills_2014)
pills_2014 <- arcos_combo %>%
group_by(state_name) %>%
inner_join(state_pop_2014, by = c("state_name" = "state")
pills_2014 <- arcos_combo %>%
group_by(state_name)
inner_join(state_pop_2014, by = c("state_name" = "state")
pills_2014 <- arcos_combo %>%
group_by(state_name)
inner_join(state_pop_2014, by = c("state_name" = "state"))
pills_2014 <- arcos_combo %>%
group_by(state_name) %>%
inner_join(state_pop_2014, by = c("state_name" = "state"))
View(pills_2014)
pills_2014 <- arcos_combo %>%
group_by(state_name) %>%
summarise(
total_pills = sum(total_2014)
)
View(pills_2014)
pills_2014 <- arcos_combo %>%
group_by(state_name) %>%
summarise(
total_pills = sum(total_2014),
total_pop = sum(total_population_2014)
)
pills_2014 <- arcos_combo %>%
group_by(state_name) %>%
inner_join(state_pop_2014, by = c("state_name" = "state"))
summarise(
total_pills = sum(total_2014),
total_pop = sum(total_population_2014)
)
pills_2014 <- arcos_combo %>%
group_by(state_name) %>%
inner_join(state_pop_2014, by = c("state_name" = "state")) %>%
summarise(
total_pills = sum(total_2014),
total_pop = sum(total_population_2014)
)
View(pills_2014)
pills_2014 <- arcos_combo %>%
group_by(state_name = case_when(
state_name == "Washington, DC" ~ "District of Columbia",
TRUE ~ state_name
)) %>%
inner_join(state_pop_2014, by = c("state_name" = "state")) %>%
summarise(
total_pills = sum(total_2014),
total_pop = sum(total_population_2014)
)
View(pills_2014)
pills_2014 <- arcos_combo %>%
group_by(state_name = case_when(
state_name == "Washington, DC" ~ "District of Columbia",
TRUE ~ state_name
)) %>%
inner_join(state_pop_2014, by = c("state_name" = "state")) %>%
summarise(
total_pills = sum(total_2014),
total_pop = sum(total_population_2014)
mutate(pills_per_person = total_pills/total_pop)
pills_2014 <- arcos_combo %>%
group_by(state_name = case_when(
state_name == "Washington, DC" ~ "District of Columbia",
TRUE ~ state_name
)) %>%
inner_join(state_pop_2014, by = c("state_name" = "state")) %>%
summarise(
total_pills = sum(total_2014),
total_pop = sum(total_population_2014),
mutate(pills_per_person = total_pills/total_pop)
)
pills_2014 <- arcos_combo %>%
group_by(state_name = case_when(
state_name == "Washington, DC" ~ "District of Columbia",
TRUE ~ state_name
)) %>%
inner_join(state_pop_2014, by = c("state_name" = "state")) %>%
summarise(
total_pills = sum(total_2014),
total_pop = sum(total_population_2014)
)
mutate(pills_per_person = total_pills/total_pop)
pills_2014 <- arcos_combo %>%
group_by(state_name = case_when(
state_name == "Washington, DC" ~ "District of Columbia",
TRUE ~ state_name
)) %>%
inner_join(state_pop_2014, by = c("state_name" = "state")) %>%
summarise(
total_pills = sum(total_2014),
total_pop = sum(total_population_2014)
) %>%
mutate(pills_per_person = total_pills/total_pop)
View(pills_2014)
pills_2014 <- arcos_combo %>%
group_by(state_name = case_when(
state_name == "Washington, DC" ~ "District of Columbia",
TRUE ~ state_name
)) %>%
inner_join(state_pop_2014, by = c("state_name" = "state")) %>%
summarise(
total_pills = sum(total_2014),
total_pop = sum(total_population_2014)
) %>%
mutate(pills_per_person = total_pills/total_pop)
arrange(desc(pills_per_person))
pills_2014 <- arcos_combo %>%
group_by(state_name = case_when(
state_name == "Washington, DC" ~ "District of Columbia",
TRUE ~ state_name
)) %>%
inner_join(state_pop_2014, by = c("state_name" = "state")) %>%
summarise(
total_pills = sum(total_2014),
total_pop = sum(total_population_2014)
) %>%
mutate(pills_per_person = total_pills/total_pop) %>%
arrange(desc(pills_per_person))
pills_2014 <- arcos_combo %>%
group_by(state_name = case_when(
state_name == "Washington, DC" ~ "District of Columbia",
TRUE ~ state_name
)) %>%
inner_join(state_pop_2014, by = c("state_name" = "state")) %>%
summarise(
total_pills = sum(total_2014),
total_pop = sum(total_population_2014)
) %>%
mutate(pills_per_person = total_pills/total_pop) %>%
arrange(desc(pills_per_person))
View(pills_2014)
