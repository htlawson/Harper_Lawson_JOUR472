---
title: ''
output:
  html_document:
    theme: cerulean
  pdf_document: default
date: "2024-04-23"
---

```{r setup, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# **An Analysis of Crime Rates in Lynchburg, Virginia from 2012 to 2023**

## Harper Lawson

### Background

This data notebook includes data from the Lynchburg Police Department, the Federal Bureau of Investigation and the World Population Review. The data ranges from 2012 to 2023.

Analysis includes that of Lynchburg's population, violent crime rate, arrests by crime, general crime report, and assaults on police officers. Also analyzed is the state of Virginia's violent crime rate.

The online data from the Lynchburg Police Department can be found [**here**](https://www.lynchburgvapolice.gov/crime/).

The online data from the F.B.I. can be found [**here**](https://cde.ucr.cjis.gov/LATEST/webapp/#/pages/explorer/crime/crime-trend).

The online data from the World Population Review can be found [**here**](https://worldpopulationreview.com/us-cities/lynchburg-va-population).

<!-- A rendered version of this data notebook can also be viewed online at https://htlawson.github.io/Harper_Lawson_JOUR472/assignment_03/assignment_03 -->

### Process

To load the necessary packages:

```{r message=FALSE, warning=FALSE}

library (tidyverse)
library (rmarkdown)
library (janitor)
library (ggplot2)
library (ggthemes)
library (dplyr)

# Assuming these packages are already installed.
# Assuming base, datasets, forcats, graphics, tibble, purrr, readr, and stats are already installed and loaded.

```

To load the necessary data:

```{r message=FALSE, warning=FALSE}

crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
  clean_names() %>%
  rename("crime_type" = x1)
general_crime_lb <- read_csv("data/general_crime_lynchburg.csv") %>%
  clean_names() %>%
  rename("crime_type" = x1)
arrests_lb <- read_csv("data/arrests_lynchburg.csv") %>%
  clean_names()
police_assaults_lb <- read_csv("data/police_assault_lynchburg.csv") %>%
  clean_names()
lb_pop <- read_csv("data/lynchburg_pop.csv") %>%
  clean_names()
va_crime <- read_csv("data/crime_rates_va.csv") %>%
  clean_names()

```

### Question 1:

#### In which areas has Lynchburg seen a *decrease* in crime? In which areas has Lynchburg seen an *increase* in crime?

```{r message=FALSE, warning=FALSE}

# To create a column with percent change from 2012 to 2023:

crime_type_lb <- crime_type_lb %>%
  mutate(pct_change = round(((x2023 - x2012) / x2012) * 100, 1))

```

```{r message=FALSE, warning=FALSE}

# To show the categories that have seen a decrease in crime:

crime_type_lb %>%
  select(crime_type, x2012, x2023, pct_change) %>%
  filter(pct_change < 0) %>%
  arrange(pct_change) %>%
  print()

```

```{r message=FALSE, warning=FALSE}

# To show the categories that have seen an increase in crime:

crime_type_lb %>%
  select(crime_type, x2012, x2023, pct_change) %>%
  filter(pct_change > 0) %>%
  arrange(desc(pct_change)) %>%
  print()

```

Lynchburg has seen an increase in Aggravated Assault, Bribery, Drug Equipment Violation, Extortion/Blackmail, Murder/Nonnegligent Manslaughter, Motor Vehicle Theft, Weapon Law Violation, Curfew/Loitering/Vagrancy Violation, and Liquor Law Violation from 2012 to 2023.

Lynchburg has seen a decrease in all other crime categories (Lynchburg Police Department).

Let's visualize 2012 and 2023's crime data:

```{r message=FALSE, warning=FALSE}

# To format the data frame:

crime_type_lb <- crime_type_lb %>%
  mutate(crime_type = str_sub(crime_type, 1, 10)) %>%
  filter("crime type" != "Total")

# To create a graph for 2012's crime data:
crime_type_lb %>%
  select(crime_type, x2012) %>%
  ggplot(aes(x = crime_type, y = x2012, fill = x2012)) +
  geom_bar(stat = "identity") +
  scale_fill_gradient(low = "#ABCFD3", high = "#007ba7") +
  scale_y_continuous(limits = c(0, 1500)) +
  labs(x = "Crime Type", y = "Number Reported",
       title = "Crimes Committed in 2012", fill = NULL) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# To create a graph for 2023's crime data:
crime_type_lb %>%
  select(crime_type, x2023) %>%
  ggplot(aes(x = crime_type, y = x2023, fill = x2023)) +
  geom_bar(stat = "identity") +
  scale_fill_gradient(low = "#ABCFD3", high = "#007ba7") +
  scale_y_continuous(limits = c(0, 1500)) +
  labs(x = "Crime Type", y = "Number Reported",
       title = "Crimes Committed in 2023", fill = NULL) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


```

### Question 2:

#### Out of all crime in Lynchburg, what trends have there been in the violent crime rate?

```{r message=FALSE, warning=FALSE}

# To adjust the general crime data frame:

updated_general_crime_lb <- general_crime_lb %>%
  select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
  slice(1) %>%
  gather(year, violent_crime) %>%
  mutate(year = str_replace(year, "x", ""))

print(updated_general_crime_lb)

```

```{r message=FALSE, warning=FALSE}

# To determine Lynchburg's violent crime rate and find the trend:

lb_pop <- lb_pop %>%
  mutate(year = as.character(year))

v_crime_rate_lb <- updated_general_crime_lb %>%
  right_join(lb_pop, by = c("year")) %>%
  select(year, population, violent_crime) %>%
  filter(year >= "2012" & year <= "2023") %>%
  mutate(rate = round((violent_crime / population) * 100000, 1))
  
v_crime_rate_lb <- v_crime_rate_lb %>%
  mutate(population = as.numeric(population))

# To display the results:

v_crime_rate_lb %>%
  select(year, rate) %>%
  print()

v_crime_dif_lb <- round(((v_crime_rate_lb$rate[12] - v_crime_rate_lb$rate[1]) / v_crime_rate_lb$rate[1]) * 100, 1)

cat("Percent change in Lynchburg's violent crime rate from 2012 to 2023:", v_crime_dif_lb, "%\n")

```

Lynchburg's violent crime rate decreased by 24% from 2012 to 2023 (Lynchburg Police Department, World Population Review).

Let's visualize this:

```{r message=FALSE, warning=FALSE}

# To create a graph:

v_crime_rate_lb %>%
  ggplot(aes(x = year, y = rate, color = rate)) +
  geom_point() +
  geom_line(aes(group = 1)) + 
  scale_y_continuous(limits = c(100, 600)) +
  scale_color_gradient(low = "#ABCFD3", high = "#007ba7") +
  labs(x = "Year", y = "Violent Crime Rate",
       title = "Lynchburg's Violent Crime Rate from 2012 to 2023", color = NULL)

```

### Question 3:

#### How does Lynchburg's violent crime rate compare to that of the state of Virginia? The United States?

##### \*The most recent comparable year is 2022.

```{r message=FALSE, warning=FALSE}

# To store Lynchburg, Virginia, and the U.S.'s 2022 violent crime rates as values:

lb_crime_rate_22 <- round(v_crime_rate_lb$rate[11], 1)
va_crime_rate_22 <- round(va_crime$x2022[1], 1)
us_crime_rate_22 <- round(va_crime$x2022[2], 1)

# To store the differences as values:

lb_va_v_crime_dif <- round((((lb_crime_rate_22 - va_crime_rate_22) / va_crime_rate_22) * 100), 1)
lb_us_v_crime_dif <- round((((lb_crime_rate_22 - us_crime_rate_22) / us_crime_rate_22) * 100), 1)

# To display the results:

print(lb_va_v_crime_dif)
print(lb_us_v_crime_dif)

cat("Lynchburg's violent crime rate was", lb_va_v_crime_dif, "%", "higher than the state of Virginia's in 2022.", "\n")
cat("Lynchburg's violent crime rate was", lb_us_v_crime_dif, "%", "lower than that of the U.S. in 2022 (Lynchburg Police Department, World Population Review, F.B.I.).", "\n")

```

Let's visualize this:

```{r message=FALSE, warning=FALSE}

# To create a violent crime rate data frame:

crime_rates_22 <- data.frame(
  place = c("Lynchburg", "Virginia", "United States"),
  crime_rate = c(lb_crime_rate_22, va_crime_rate_22, us_crime_rate_22)
)

# To create a graph:

crime_rates_22 %>%
  ggplot(aes(x = place, y = crime_rate)) +
  geom_point(aes(color = crime_rate, size = crime_rate)) +
  scale_y_continuous(limits = c(200, 400)) +
  scale_color_gradient(low = "#ABCFD3", high = "#007ba7") +
  scale_size(range = c(6, 10)) +
  labs(x = "Place", y = "Violent Crime Rate",
       title = "2022 Violent Crime Rates Compared", color = NULL) +
  guides(size = FALSE)


```

### Question 4:

#### Which year saw the most crime in Lynchburg? The least?

```{r message=FALSE, warning=FALSE}

# To refresh the data:

crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
  clean_names() %>%
  rename("crime_type" = x1)

```

```{r message=FALSE, warning=FALSE}

# To add a Total row to the Lynchburg crime type data frame:

total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
total_row <- as.numeric(total_row)
crime_type_lb <- rbind(crime_type_lb, c("Total", total_row))

# To find the total crime rate per 1,000 people:
  
updated_crime_type_lb <- crime_type_lb %>%
  select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
  slice(as.numeric(46)) %>%
  gather(year, total_crime) %>%
  mutate(year = str_replace(year, "x", ""),
         total_crime = as.numeric(total_crime))

total_crime_rate_lb <- v_crime_rate_lb %>%
  right_join(updated_crime_type_lb, by = c("year")) %>%
  select(year, population, total_crime) %>%
  filter(year >= "2012" & year <= "2023") %>%
  mutate(crimes_per_1000 = round((total_crime / population) * 1000, 1))

# To display the results:

total_crime_rate_lb %>%
  arrange(desc(crimes_per_1000)) %>%
  print()

```

2012 saw the most crime in Lynchburg with 115 crimes reporter per 1,000 people. 2023 saw the least amount of crime with a reported 81 crimes per 1,000 people (Lynchburg Police Department, World Population Review).

Let's visualize this:

```{r message=FALSE, warning=FALSE}

# To create a graph:

total_crime_rate_lb %>%
  ggplot(aes(x = year, y = crimes_per_1000, color = crimes_per_1000)) +
  geom_point() +
  geom_line(aes(group = 1)) + 
  scale_y_continuous(limits = c(0, 150)) +
  scale_color_gradient(low = "#ABCFD3", high = "#007ba7") +
  labs(x = "Year", y = "Crime Rate",
       title = "Lynchburg's Crime Rate per 1,000 people from 2012 to 2023", color = NULL)

```

### Question 5:

#### What is the most common crime committed in Lynchburg? The least?

```{r message=FALSE, warning=FALSE}

# To refresh the data:

crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
  clean_names() %>%
  rename("crime_type" = x1)

```

```{r message=FALSE, warning=FALSE}

# To add a Total column to the Lynchburg crime type data frame:

total_row <- rowSums(crime_type_lb[, -1], na.rm = TRUE)

crime_type_lb$Total <- total_row

# To display the results:

crime_type_lb %>%
  select(crime_type, Total) %>%
  arrange(desc(Total)) %>%
  print()

```

While "All Other Offenses" were reported more than any specific crime, Larceny was the most committed crime in Lynchburg with 13,371 reports from 2012 to 2023.

Negligent Manslaughter was the least committed crime with only 2 reports from 2012 to 2023 (Lynchburg Police Department).

Let's visualize violent crime totals versus property crime totals:

```{r message=FALSE, warning=FALSE}

# To format the data frame:

updated_general_crime_lb <- general_crime_lb %>%
  gather(key = "year", value = "count", -crime_type) %>%
  mutate(year = str_replace(year, "x", "")) %>%
  spread(key = "crime_type", value = "count") %>%
  clean_names()

# To create a graph:

updated_general_crime_lb %>%
  select(year, violent_crime, property_crime) %>%
  pivot_longer(cols = c(violent_crime, property_crime), names_to = "crime_type", values_to = "Total") %>%
  ggplot(aes(x = year, y = Total, fill = crime_type)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8)) +
  scale_fill_manual(values = c("#ABCFD3", "#007ba7"), labels = c("Property Crime", "Violent Crime")) +
  scale_y_continuous(limits = c(0, 2500)) +
  labs(x = "Year", y = "Number Reported",
       title = "Crime Totals from 2012 to 2023", fill = NULL) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


```

### Memo:

#### Key findings

Overall, the city of Lynchburg, Virginia has shown positive trends in crime from 2012 to 2023. Both the general crime rate and violent crime rate are down, even though the population has increased since 2012. Below, I will break down these trends in terms of reported crime numbers by category, Lynchburg's population, and the information relative to that of the state of Virginia as well as the United States.

One of the most interesting/newsworthy findings is Lynchburg's decrease in Disorderly Conduct. This crime category had a substantial number of reports over the years, and it was definitely tracked up until 2023. Going from 97 reports in 2012 to 40 in 2023, there was a 60 percent decrease in Disorderly Conduct.

On the other hand, Lynchburg saw 100+ percent increases in seven different categories of crime, but it was the reported totals of Drug Equipment Violations, motor Vehicle Thefts and Weapon Law Violations that are truly worth noting. These three crime types had a substantial number of reports in 2012, and an even more substantial number in 2023. Drug Equipment Violations, beginning with 34 reports in 2012 and having 149 reports in 2023, showed a 338 percent increase. Motor Vehicle Thefts, going from 74 reports in 2012 to 248 reports in 2023, saw a 235 percent increase. Lastly, there were 111 reports of Weapon Law Violations in 2012 and 234 reports in 2023, showing a 111 percent increase.

Another interesting finding is that Lynchburg saw a 32 percent decrease in its violent crime rate from 2012 to 2023. Also, its violent crime rate as of 2022 was 62 percent higher than the state of Virginia's but about the same as that of the U.S. This goes to show that Virginia as a whole has a relatively low violent crime rate by comparison, an unexpected finding.

Question 4 revealed that Lynchburg's crime rate has been on a steady decline. 2023 saw the fewest amount of crimes reported since 2012, which saw the highest count on the spectrum.

Lastly, Larceny being the most committed (reported) crime in Lynchburg is intriguing. Larceny, or the theft of personal property, saw a 39 percent decrease from 2012 to 2023, but was still reported far more than any other specific crime each year.

#### Pros and Cons of the Data

The largest pro of the data analyzed from the Lynchburg Police Department, the World Population Review and the F.B.I. was that it was all relatively easy to interpret. Every data set used needed various sorts of cleaning and organizing, but no drastic restructuring was necessary at any point during my analysis.

Also, there was simply more data available than I originally anticipated. The Lynchburg Police Department's website offers an extensive collection of data sets, not just on crimes and crime rates but also arrests, assaults on police, parking violations and more. The data sets that were used in this analysis included very helpful categorizations like breaking up crime reports into the individual types as well as labeling them as either violent or property crimes.

A con I faced was the lack of context that came with certain statistics. For example, I was not sure if certain years that showed zero reports of a certain crime type really did experience no reports of that crime, or if it had simply ceased being tracked.

#### On Future Verification

If I were to use any of my findings as facts in a published story, I would certainly seek further verification. I imagine this would involve consulting data from the U.S. Census Bureau as well as contacting the Lynchburg Police Department directly. It would be important to read over their methodology in compiling the data, as well as seek any other verification and information they could provide.

<br>
