---
title: "Lawson_assignment_03"
output: html_document
date: "2024-04-23"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# **An Analysis of Crime Rates in Lynchburg, Virginia from 2012 to 2023**

## Harper Lawson

### Background

This data notebook includes data from the Lynchburg Police Department, the Federal Bureau of Investigation and the World Population Review. The data ranges from 2012-2023.

Analysis includes that of Lynchburg's population, violent crime rate, arrests by crime, general crime report, and assaults on police officers. Also analyzed is the state of Virginia's violent crime rate.

The online data from the Lynchburg Police Department can be found [here](https://www.lynchburgvapolice.gov/crime/).

The online data from the FBI can be found [here](https://cde.ucr.cjis.gov/LATEST/webapp/#/pages/explorer/crime/crime-trend).

The online data from the World Population Review can be found [here](https://worldpopulationreview.com/us-cities/lynchburg-va-population).

### Process

To load the necessary packages:

```{r}

library (tidyverse)
library (tidycensus)
library (rmarkdown)
library (janitor)
library (ggplot2)
library (ggthemes)
library (dplyr)

# Assuming these packages are already installed.
# Assuming base, datasets, forcats, graphics, tibble, purrr, readr, and stats are already installed and loaded.

```

To load the necessary data:

```{r}

crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
  clean_names()
general_crime_lb <- read_csv("data/general_crime_lynchburg.csv") %>%
  clean_names()
arrests_lb <- read_csv("data/arrests_lynchburg.csv") %>%
  clean_names()
police_assaults_lb <- read_csv("data/police_assault_lynchburg.csv") %>%
  clean_names()
lb_pop <- read_csv("data/lynchburg_pop.csv") %>%
  clean_names()
va_crime <- read_csv("data/crime_rates_va.csv") %>%
  clean_names()

```

### Question 1:

#### In which areas has Lynchburg seen a *decrease* in crime? In which areas has Lynchburg seen an *increase* in crime?

```{r}

# To create a column with percent change from 2012 to 2023:

crime_type_lb <- crime_type_lb %>%
  mutate(pct_change = ((x2023-x2012)/x2012) * 100)

```

```{r}

# To show the categories that have seen a decrease in crime:

crime_type_lb %>%
  select(x1, pct_change) %>%
  filter(pct_change < 0) %>%
  arrange(pct_change) %>%
  print()

```

```{r}

# To show the categories that have seen an increase in crime:

crime_type_lb %>%
  select(x1, pct_change) %>%
  filter(pct_change > 0) %>%
  arrange(desc(pct_change)) %>%
  print()

```

Lynchburg has seen an increase in Aggravated Assault, Bribery, Drug Equipment Violation, Extortion/Blackmail, Murder/Nonnegligent Manslaughter, Motor Vehicle Theft, Weapon Law Violation, Curfew/Loitering/Vagrancy Violation, and Liquor Law Violation.

Lynchburg has seen a decrease in all other crime categories.

### Question 2:

#### Out of all crime in Lynchburg, what trends have there been in the violent crime rate?

```{r}

# To adjust the general crime data frame:

updated_general_crime_lb <- tibble(
  "Year" = c("x2012", "x2013", "x2014", "x2015", "x2016", "x2017", "x2018", "x2019", "x2020", "x2021", "x2022", "x2023"),
  "Violent Crime" = c(336, 370, 393, 352, 370, 313, 302, 327, 349, 333, 301, 261),
) %>%
  clean_names()

print(updated_general_crime_lb)

```

```{r}

# To determine Lynchburg's violent crime rate and find the trend:

lb_pop <- lb_pop %>%
  mutate(year = as.character(year))

updated_general_crime_lb <- updated_general_crime_lb %>%
  mutate(year = str_replace(year, "x", ""))

v_crime_rate_lb <- updated_general_crime_lb %>%
  right_join(lb_pop, by = c("year")) %>%
  select(year, population, violent_crime) %>%
  filter(year >= "2012" & year <= "2023") %>%
  mutate(rate = (violent_crime/population) * 100000)

# To display the results:

v_crime_rate_lb %>%
  select(year, rate) %>%
  print()

v_crime_dif_lb <- (((328.5333-434.5240)/328.5333) * 100)
cat("Percent change in Lynchburg's violent crime rate from 2012-2023:", v_crime_dif_lb, "%\n")

```

Lynchburg's violent crime rate decreased by 32% from 2012-2023.

### Question 3:

#### How does Lynchburg's violent crime rate compare to that of the state of Virginia? The United States?

##### \*The most recent year able to compare is 2022.

```{r}

# To store Lynchburg, Virginia and the U.S.'s 2022 violent crime rates as values:

lb_crime_rate_22 <- v_crime_rate_lb$rate[11]
va_crime_rate_22 <- va_crime$x2022[1]
us_crime_rate_22 <- va_crime$x2022[2]

# To store the differences as values:

lb_va_v_crime_dif <- (((lb_crime_rate_22-va_crime_rate_22)/va_crime_rate_22) * 100)
lb_us_v_crime_dif <- (((lb_crime_rate_22-us_crime_rate_22)/us_crime_rate_22) * 100)

# To display the results:

print(lb_va_v_crime_dif)
print(lb_us_v_crime_dif)

cat("Lynchburg's violent crime rate was", lb_va_v_crime_dif, "%", "higher than the state of Virginia's in 2022.", "\n")
cat("Lynchburg's violent crime rate was", lb_us_v_crime_dif, "%", "lower than that of the U.S. in 2022.", "\n")

```

### Question 4:

#### Which year saw the most crime in Lynchburg? The least?

```{r}

# To refresh the data:

crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
  clean_names()

```

```{r}

# To add a Total row to the Lynchburg crime type data frame:

total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)

crime_type_lb <- rbind(crime_type_lb, c("Total", total_row))

# To display the results:

crime_type_lb %>%
  slice(46) %>%
  print()

```

2012 saw the most crime in Lynchburg with 8,900 total crimes being reported. 2023 saw the least amount of crime with a reported 6,422 crimes.

### Question 5:

#### What is the most common crime committed in Lynchburg? The least?

```{r}

# To refresh the data:

crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
  clean_names()

```

```{r}

# To add a Total column to the Lynchburg crime type data frame:

total_row <- rowSums(crime_type_lb[, -1], na.rm = TRUE)

crime_type_lb$Total <- total_row

# To display the results:

crime_type_lb %>%
  select(x1, Total) %>%
  arrange(desc(Total)) %>%
  print()

```

While "All Other Offenses" were reported more than any specific crime, Larceny was the most committed crime in Lynchburg with 13,371 reports from 2012-2023.

Negligent Manslaughter was the least committed crime with only 2 reports from 2012-2023.

### Findings:

So far, one of the most interesting/newsworthy findings is that Lynchburg saw a 100% decrease in six different categories of crime: Gambling Offenses, Negligent Manslaughter, Prostitution, Bad Check, Peeping Tom, and Runaway. While a couple of these crime types never saw many reports in the first place, a 100 percent decrease still definitely stands out.

On the other hand, Lynchburg saw 100+ percent increases in seven different categories of crime: Curfew/Loitering/Vagrancy Violation, Drug Equipment Violation, Motor Vehicle Theft, Bribery, Extortion/Bribery, Weapon Law Violation and Aggravated Assault. Curfew/Loitiering/Vagrancy Violation saw the highest increase at 350 percent.

Another interesting finding is that Lynchburg saw a 32 percent decrease in its violent crime rate from 2012-2023. Also, that its violent crime rate as of 2022 was 62% higher than the state of Virginia's but about the same as that of the U.S. This goes to show that Virginia as a whole has a relatively low violent crime rate.

Question 4 revealed that Lynchburg's crime rate has been on a steady decline. 2023 saw the fewest amount of crimes reported starting with 2012, the highest count on the spectrum.

Lastly, Larceny being the most committed (reported) crime in Lynchburg is definitely newsworthy. Larceny means stealing personal property, and while it saw a 39% decrease from 2012-2023, it was still reported far more than any other specific crime each year.
