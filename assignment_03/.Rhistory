mutate(year = str_replace(year, "x", ""))
# To determine Lynchburg's violent crime rate and find the trend:
lb_pop <- lb_pop %>%
mutate(year = as.character(year))
updated_general_crime_lb <- updated_general_crime_lb %>%
rename_with(~ str_replace(., "x", ""), everything())
v_crime_rate_lb <- updated_general_crime_lb %>%
right_join(lb_pop, by = c("year")) %>%
select(year, population, violent_crime) %>%
filter(year >= "2012" & year <= "2023") %>%
mutate(rate = (violent_crime/population) * 100000)
View(lb_pop)
# To determine Lynchburg's violent crime rate and find the trend:
lb_pop <- lb_pop %>%
mutate(year = as.character(year))
updated_general_crime_lb <- updated_general_crime_lb %>%
rename_with(~ str_replace(., "x", ""), everything())
v_crime_rate_lb <- updated_general_crime_lb %>%
right_join(lb_pop, by = c("year")) %>%
select(year, population, violent_crime) %>%
filter(year >= "2012" & year <= "2023") %>%
mutate(rate = (violent_crime/population) * 100000)
# To adjust the general crime data frame:
updated_general_crime_lb <- general_crime_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(1)
print(updated_general_crime_lb)
# To adjust the general crime data frame:
updated_general_crime_lb <- general_crime_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(1) %>%
gather(year, value)
print(updated_general_crime_lb)
# To adjust the general crime data frame:
updated_general_crime_lb <- general_crime_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(1) %>%
gather(year, value)
updated_general_crime_lb <- updated_general_crime_lb %>%
rename_with(~ str_replace(., "x", ""), everything())
print(updated_general_crime_lb)
# To adjust the general crime data frame:
updated_general_crime_lb <- general_crime_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(1) %>%
gather(year, value)
print(updated_general_crime_lb)
# To determine Lynchburg's violent crime rate and find the trend:
lb_pop <- lb_pop %>%
mutate(year = as.character(year))
v_crime_rate_lb <- updated_general_crime_lb %>%
right_join(lb_pop, by = c("year")) %>%
select(year, population, violent_crime) %>%
filter(year >= "2012" & year <= "2023") %>%
mutate(rate = (violent_crime/population) * 100000)
# To adjust the general crime data frame:
updated_general_crime_lb <- general_crime_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(1) %>%
gather(year, violent_crime)
print(updated_general_crime_lb)
# To determine Lynchburg's violent crime rate and find the trend:
lb_pop <- lb_pop %>%
mutate(year = as.character(year))
v_crime_rate_lb <- updated_general_crime_lb %>%
right_join(lb_pop, by = c("year")) %>%
select(year, population, violent_crime) %>%
filter(year >= "2012" & year <= "2023") %>%
mutate(rate = (violent_crime/population) * 100000)
# To display the results:
v_crime_rate_lb %>%
select(year, rate) %>%
print()
v_crime_dif_lb <- (((328.5333-434.5240)/328.5333) * 100)
cat("Percent change in Lynchburg's violent crime rate from 2012-2023:", v_crime_dif_lb, "%\n")
# To adjust the general crime data frame:
updated_general_crime_lb <- general_crime_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(1) %>%
gather(year, violent_crime) %>%
mutate(year = str_replace(year, "x", ""))
print(updated_general_crime_lb)
# To determine Lynchburg's violent crime rate and find the trend:
lb_pop <- lb_pop %>%
mutate(year = as.character(year))
v_crime_rate_lb <- updated_general_crime_lb %>%
right_join(lb_pop, by = c("year")) %>%
select(year, population, violent_crime) %>%
filter(year >= "2012" & year <= "2023") %>%
mutate(rate = (violent_crime/population) * 100000)
# To display the results:
v_crime_rate_lb %>%
select(year, rate) %>%
print()
v_crime_dif_lb <- (((328.5333-434.5240)/328.5333) * 100)
cat("Percent change in Lynchburg's violent crime rate from 2012-2023:", v_crime_dif_lb, "%\n")
View(v_crime_rate_lb)
# To determine Lynchburg's violent crime rate and find the trend:
lb_pop <- lb_pop %>%
mutate(year = as.character(year))
v_crime_rate_lb <- updated_general_crime_lb %>%
right_join(lb_pop, by = c("year")) %>%
select(year, population, violent_crime) %>%
filter(year >= "2012" & year <= "2023") %>%
mutate(rate = (violent_crime/population) * 100000)
# To display the results:
v_crime_rate_lb %>%
select(year, rate) %>%
print()
v_crime_dif_lb <- (((v_crime_rate_lb$rate[1]-v_crime_rate_lb$rate[12])/v_crime_rate_lb$rate[1]) * 100)
cat("Percent change in Lynchburg's violent crime rate from 2012-2023:", v_crime_dif_lb, "%\n")
# To determine Lynchburg's violent crime rate and find the trend:
lb_pop <- lb_pop %>%
mutate(year = as.character(year))
v_crime_rate_lb <- updated_general_crime_lb %>%
right_join(lb_pop, by = c("year")) %>%
select(year, population, violent_crime) %>%
filter(year >= "2012" & year <= "2023") %>%
mutate(rate = (violent_crime/population) * 100000)
# To display the results:
v_crime_rate_lb %>%
select(year, rate) %>%
print()
v_crime_dif_lb <- (((v_crime_rate_lb$rate[12]-v_crime_rate_lb$rate[1])/v_crime_rate_lb$rate[1]) * 100)
cat("Percent change in Lynchburg's violent crime rate from 2012-2023:", v_crime_dif_lb, "%\n")
View(v_crime_rate_lb)
# To refresh the data:
crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
clean_names()
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
crime_type_lb <- rbind(crime_type_lb, c("Total", total_row))
# To display the results:
crime_type_lb %>%
slice(46) %>%
print()
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
# To refresh the data:
crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
clean_names()
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
crime_type_lb <- rbind(crime_type_lb, c("Total", total_row))
# To display the results:
crime_type_lb %>%
slice(46) %>%
print()
View(crime_type_lb)
View(updated_general_crime_lb)
View(v_crime_rate_lb)
View(crime_type_lb)
View(general_crime_lb)
View(updated_general_crime_lb)
updated_crime_type_lb <- crime_type_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(46) %>%
gather(year, total_crime)
View(updated_crime_type_lb)
updated_crime_type_lb <- crime_type_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(46) %>%
gather(year, total_crime) %>%
mutate(year = str_replace(year, "x", ""))
View(updated_crime_type_lb)
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
# To refresh the data:
crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
clean_names()
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
crime_type_lb <- rbind(crime_type_lb, c("Total", total_row))
# To find the total crime rate per 1,000 people:
crime_type_lb %>%
updated_crime_type_lb <- crime_type_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(46) %>%
gather(year, total_crime) %>%
mutate(year = str_replace(year, "x", ""))
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
# To refresh the data:
crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
clean_names()
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
crime_type_lb <- rbind(crime_type_lb, c("Total", total_row))
# To find the total crime rate per 1,000 people:
updated_crime_type_lb <- crime_type_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(46) %>%
gather(year, total_crime) %>%
mutate(year = str_replace(year, "x", ""))
total_crime_rate_lb <- v_crime_rate_lb %>%
right_join(updated_crime_type_lb, by = c("year")) %>%
select(year, population, total_crime) %>%
filter(year >= "2012" & year <= "2023") %>%
mutate(rate = (total_crime/population) * 1000)
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
# To refresh the data:
crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
clean_names()
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
crime_type_lb <- rbind(crime_type_lb, c("Total", total_row))
# To find the total crime rate per 1,000 people:
updated_crime_type_lb <- crime_type_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(46) %>%
gather(year, total_crime) %>%
mutate(year = str_replace(year, "x", ""))
updated_crime_type_lb$total_crime <- as.numeric(updated_crime_type_lb$total_crime)
updated_crime_type_lb$population <- as.numeric(updated_crime_type_lb$population)
# To refresh the data:
crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
clean_names()
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
crime_type_lb <- rbind(crime_type_lb, c("Total", total_row))
# To find the total crime rate per 1,000 people:
updated_crime_type_lb <- crime_type_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(46) %>%
gather(year, total_crime) %>%
mutate(year = str_replace(year, "x", ""))
total_crime_rate_lb <- v_crime_rate_lb %>%
right_join(updated_crime_type_lb, by = c("year")) %>%
select(year, population, total_crime) %>%
filter(year >= "2012" & year <= "2023") %>%
mutate(rate = (total_crime/population) * 1000)
# To refresh the data:
crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
clean_names()
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
crime_type_lb <- rbind(crime_type_lb, c("Total", total_row))
# To find the total crime rate per 1,000 people:
updated_crime_type_lb <- crime_type_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(as.numeric(46)) %>%
gather(year, total_crime) %>%
mutate(year = str_replace(year, "x", ""))
total_crime_rate_lb <- v_crime_rate_lb %>%
right_join(updated_crime_type_lb, by = c("year")) %>%
select(year, population, total_crime) %>%
filter(year >= "2012" & year <= "2023") %>%
mutate(rate = (total_crime/population) * 1000)
# To determine Lynchburg's violent crime rate and find the trend:
lb_pop <- lb_pop %>%
mutate(year = as.character(year))
v_crime_rate_lb <- updated_general_crime_lb %>%
right_join(lb_pop, by = c("year")) %>%
select(year, population, violent_crime) %>%
filter(year >= "2012" & year <= "2023") %>%
mutate(rate = (violent_crime/population) * 100000)
v_crime_rate_lb <- v_crime_rate_lb %>%
mutate(population = as.numeric(population))
# To display the results:
v_crime_rate_lb %>%
select(year, rate) %>%
print()
v_crime_dif_lb <- (((v_crime_rate_lb$rate[12]-v_crime_rate_lb$rate[1])/v_crime_rate_lb$rate[1]) * 100)
cat("Percent change in Lynchburg's violent crime rate from 2012-2023:", v_crime_dif_lb, "%\n")
# To refresh the data:
crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
clean_names()
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
crime_type_lb <- rbind(crime_type_lb, c("Total", total_row))
# To find the total crime rate per 1,000 people:
updated_crime_type_lb <- crime_type_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(as.numeric(46)) %>%
gather(year, total_crime) %>%
mutate(year = str_replace(year, "x", ""))
total_crime_rate_lb <- v_crime_rate_lb %>%
right_join(updated_crime_type_lb, by = c("year")) %>%
select(year, population, total_crime) %>%
filter(year >= "2012" & year <= "2023") %>%
mutate(rate = (total_crime/population) * 1000)
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
# To refresh the data:
crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
clean_names()
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
total_row <- as.numeric(total_row)
crime_type_lb <- rbind(crime_type_lb, c("Total", total_row))
# To find the total crime rate per 1,000 people:
updated_crime_type_lb <- crime_type_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(as.numeric(46)) %>%
gather(year, total_crime) %>%
mutate(year = str_replace(year, "x", ""))
total_crime_rate_lb <- v_crime_rate_lb %>%
right_join(updated_crime_type_lb, by = c("year")) %>%
select(year, population, total_crime) %>%
filter(year >= "2012" & year <= "2023") %>%
mutate(rate = (total_crime/population) * 1000)
# To determine Lynchburg's violent crime rate and find the trend:
lb_pop <- lb_pop %>%
mutate(year = as.character(year))
v_crime_rate_lb <- updated_general_crime_lb %>%
right_join(lb_pop, by = c("year")) %>%
select(year, population, violent_crime) %>%
filter(year >= "2012" & year <= "2023") %>%
mutate(rate = (violent_crime/population) * 100000)
v_crime_rate_lb <- v_crime_rate_lb %>%
mutate(population = as.numeric(population))
# To display the results:
v_crime_rate_lb %>%
select(year, rate) %>%
print()
v_crime_dif_lb <- (((v_crime_rate_lb$rate[12]-v_crime_rate_lb$rate[1])/v_crime_rate_lb$rate[1]) * 100)
cat("Percent change in Lynchburg's violent crime rate from 2012-2023:", v_crime_dif_lb, "%\n")
# To determine Lynchburg's violent crime rate and find the trend:
lb_pop <- lb_pop %>%
mutate(year = as.character(year))
v_crime_rate_lb <- updated_general_crime_lb %>%
right_join(lb_pop, by = c("year")) %>%
select(year, population, violent_crime) %>%
filter(year >= "2012" & year <= "2023") %>%
mutate(rate = (violent_crime/population) * 100000)
v_crime_rate_lb <- v_crime_rate_lb %>%
mutate(population = as.numeric(population))
# To display the results:
v_crime_rate_lb %>%
select(year, rate) %>%
print()
v_crime_dif_lb <- (((v_crime_rate_lb$rate[12]-v_crime_rate_lb$rate[1])/v_crime_rate_lb$rate[1]) * 100)
cat("Percent change in Lynchburg's violent crime rate from 2012-2023:", v_crime_dif_lb, "%\n")
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
# To refresh the data:
crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
clean_names()
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
total_row <- as.numeric(total_row)
crime_type_lb <- rbind(crime_type_lb, c("Total", total_row))
# To find the total crime rate per 1,000 people:
updated_crime_type_lb <- crime_type_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(as.numeric(46)) %>%
gather(year, total_crime) %>%
mutate(year = str_replace(year, "x", ""))
total_crime_rate_lb <- v_crime_rate_lb %>%
right_join(updated_crime_type_lb, by = c("year")) %>%
select(year, population, total_crime) %>%
filter(year >= "2012" & year <= "2023") %>%
mutate(rate = (total_crime/population) * 1000)
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
# To refresh the data:
crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
clean_names()
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
total_row <- as.numeric(total_row)
crime_type_lb <- rbind(crime_type_lb, c("Total", total_row))
# To find the total crime rate per 1,000 people:
updated_crime_type_lb <- crime_type_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(as.numeric(46)) %>%
gather(year, total_crime) %>%
mutate(year = str_replace(year, "x", "")),
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
# To refresh the data:
crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
clean_names()
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
total_row <- as.numeric(total_row)
crime_type_lb <- rbind(crime_type_lb, c("Total", total_row))
# To find the total crime rate per 1,000 people:
updated_crime_type_lb <- crime_type_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(as.numeric(46)) %>%
gather(year, total_crime) %>%
mutate(year = str_replace(year, "x", "")),
# To refresh the data:
crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
clean_names()
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
total_row <- as.numeric(total_row)
crime_type_lb <- rbind(crime_type_lb, c("Total", total_row))
# To find the total crime rate per 1,000 people:
updated_crime_type_lb <- crime_type_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(as.numeric(46)) %>%
gather(year, total_crime) %>%
mutate(year = str_replace(year, "x", ""),
total_crime = as.numeric(total_crime))
total_crime_rate_lb <- v_crime_rate_lb %>%
right_join(updated_crime_type_lb, by = c("year")) %>%
select(year, population, total_crime) %>%
filter(year >= "2012" & year <= "2023") %>%
mutate(rate = (total_crime/population) * 1000)
# To display the results:
total_crime_rate_lb %>%
print()
View(total_crime_rate_lb)
total_crime_rate_lb %>%
arrange(desc(rate))
print()
total_crime_rate_lb %>%
arrange(desc(rate)) %>%
print()
View(total_crime_rate_lb)
crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
clean_names()
general_crime_lb <- read_csv("data/general_crime_lynchburg.csv") %>%
clean_names()
arrests_lb <- read_csv("data/arrests_lynchburg.csv") %>%
clean_names()
police_assaults_lb <- read_csv("data/police_assault_lynchburg.csv") %>%
clean_names()
lb_pop <- read_csv("data/lynchburg_pop.csv") %>%
clean_names()
va_crime <- read_csv("data/crime_rates_va.csv") %>%
clean_names()
# To create a column with percent change from 2012 to 2023:
crime_type_lb <- crime_type_lb %>%
mutate(pct_change = ((x2023-x2012)/x2012) * 100)
# To show the categories that have seen a decrease in crime:
crime_type_lb %>%
select(x1, x2012, x2023, pct_change) %>%
filter(pct_change < 0) %>%
arrange(pct_change) %>%
print()
# To show the categories that have seen an increase in crime:
crime_type_lb %>%
select(x1, x2012, x2023, pct_change) %>%
filter(pct_change > 0) %>%
arrange(desc(pct_change)) %>%
print()
# To adjust the general crime data frame:
updated_general_crime_lb <- general_crime_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(1) %>%
gather(year, violent_crime) %>%
mutate(year = str_replace(year, "x", ""))
print(updated_general_crime_lb)
# To determine Lynchburg's violent crime rate and find the trend:
lb_pop <- lb_pop %>%
mutate(year = as.character(year))
v_crime_rate_lb <- updated_general_crime_lb %>%
right_join(lb_pop, by = c("year")) %>%
select(year, population, violent_crime) %>%
filter(year >= "2012" & year <= "2023") %>%
mutate(rate = (violent_crime/population) * 100000)
v_crime_rate_lb <- v_crime_rate_lb %>%
mutate(population = as.numeric(population))
# To display the results:
v_crime_rate_lb %>%
select(year, rate) %>%
print()
v_crime_dif_lb <- (((v_crime_rate_lb$rate[12]-v_crime_rate_lb$rate[1])/v_crime_rate_lb$rate[1]) * 100)
cat("Percent change in Lynchburg's violent crime rate from 2012-2023:", v_crime_dif_lb, "%\n")
# To store Lynchburg, Virginia and the U.S.'s 2022 violent crime rates as values:
lb_crime_rate_22 <- v_crime_rate_lb$rate[11]
va_crime_rate_22 <- va_crime$x2022[1]
us_crime_rate_22 <- va_crime$x2022[2]
# To store the differences as values:
lb_va_v_crime_dif <- (((lb_crime_rate_22-va_crime_rate_22)/va_crime_rate_22) * 100)
lb_us_v_crime_dif <- (((lb_crime_rate_22-us_crime_rate_22)/us_crime_rate_22) * 100)
# To display the results:
print(lb_va_v_crime_dif)
print(lb_us_v_crime_dif)
cat("Lynchburg's violent crime rate was", lb_va_v_crime_dif, "%", "higher than the state of Virginia's in 2022.", "\n")
cat("Lynchburg's violent crime rate was", lb_us_v_crime_dif, "%", "lower than that of the U.S. in 2022.", "\n")
# To refresh the data:
crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
clean_names()
# To add a Total row to the Lynchburg crime type data frame:
total_row <- colSums(crime_type_lb[, -1], na.rm = TRUE)
total_row <- as.numeric(total_row)
crime_type_lb <- rbind(crime_type_lb, c("Total", total_row))
# To find the total crime rate per 1,000 people:
updated_crime_type_lb <- crime_type_lb %>%
select(x2012, x2013, x2014, x2015, x2016, x2017, x2018, x2019, x2020, x2021, x2022, x2023) %>%
slice(as.numeric(46)) %>%
gather(year, total_crime) %>%
mutate(year = str_replace(year, "x", ""),
total_crime = as.numeric(total_crime))
total_crime_rate_lb <- v_crime_rate_lb %>%
right_join(updated_crime_type_lb, by = c("year")) %>%
select(year, population, total_crime) %>%
filter(year >= "2012" & year <= "2023") %>%
mutate(rate = (total_crime/population) * 1000)
# To display the results:
total_crime_rate_lb %>%
arrange(desc(rate)) %>%
print()
# To refresh the data:
crime_type_lb <- read_csv("data/crime_type_lynchburg.csv") %>%
clean_names()
# To add a Total column to the Lynchburg crime type data frame:
total_row <- rowSums(crime_type_lb[, -1], na.rm = TRUE)
crime_type_lb$Total <- total_row
# To display the results:
crime_type_lb %>%
select(x1, Total) %>%
arrange(desc(Total)) %>%
print()
